<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø§Ù„Ù…ØµØ­Ù Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ</title>
  <style>
    body { font-family: 'Amiri', serif; line-height: 2; margin: 20px; }
    .word { cursor: pointer; padding: 2px; }
    .tooltip {
      position: absolute;
      background: #fff;
      border: 1px solid #ccc;
      padding: 8px;
      display: none;
      z-index: 1000;
      max-width: 300px;
    }
  </style>
</head>
<body>

<h2>ğŸ“– Ø§Ù„Ù…ØµØ­Ù Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ</h2>
<div id="quran"></div>
<div id="tooltip" class="tooltip"></div>

<script>
  let dictionary = {};

  // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¹Ø¬Ù… Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØµÙØ­Ø©
  async function loadDictionary() {
    try {
      const res = await fetch("https://hikmavideohub-bot.github.io/quran/dictionary.json");
      if (!res.ok) throw new Error("Failed to load dictionary: " + res.status);
      dictionary = await res.json();
      console.log("Dictionary loaded:", dictionary);
    } catch (err) {
      console.error("Error loading dictionary:", err);
    }
  }

  // ØªØ­Ù…ÙŠÙ„ Ø³ÙˆØ±Ø© Ù…Ø¹ÙŠÙ†Ø©
  async function loadVerse(sura = 1) {
    const container = document.getElementById("quran");
    container.innerHTML = "";  // Ù†Ø¸Ù‘Ù Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ

    try {
      const res = await fetch(`https://api.quran.com/api/v4/quran/verses/uthmani?sura_number=${sura}`);
      if (!res.ok) throw new Error("Failed to load Quran text: " + res.status);
      const data = await res.json();

      data.verses.forEach(v => {
        const verseDiv = document.createElement("div");
        // ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ ÙƒÙ„Ù…Ø§Øª
        v.text_uthmani.split(" ").forEach(word => {
          const span = document.createElement("span");
          span.className = "word";
          span.textContent = word + " ";
          span.addEventListener("click", (event) => {
            showMeaning(word, event);
          });
          verseDiv.appendChild(span);
        });
        container.appendChild(verseDiv);
      });
    } catch (err) {
      console.error("Error loading Quran:", err);
    }
  }

  // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¹Ù†Ù‰
  function showMeaning(word, event) {
    const tooltip = document.getElementById("tooltip");
    const meaning = dictionary[word] || "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø¹Ù†Ù‰";
    tooltip.textContent = word + " : " + meaning;
    tooltip.style.left = event.pageX + "px";
    tooltip.style.top = event.pageY + "px";
    tooltip.style.display = "block";

    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªÙˆÙ„ØªÙŠØ¨ Ù„Ùˆ Ø¶ØºØ· ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù† Ø¢Ø®Ø±
    document.addEventListener("click", (e) => {
      if (!tooltip.contains(e.target) && !e.target.classList.contains("word")) {
        tooltip.style.display = "none";
      }
    }, { once: true });
  }

  // Ø¨Ø¯Ø§ÙŠØ© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¹Ø¬Ù… ÙˆØ§Ù„Ù†Øµ
  loadDictionary().then(() => {
    loadVerse(1);  // ÙŠØ¹Ø±Ø¶ Ø³ÙˆØ±Ø© Ø§Ù„ÙØ§ØªØ­Ø© ÙƒØ¨Ø¯Ø§ÙŠØ©
  });
</script>

</body>
</html>
